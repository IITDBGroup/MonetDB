# OID list compressions

o := 19531025:int;

b:= bat.new(:int);
bat.append(b,50);
bat.append(b,50);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,o);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
bat.append(b,9);
b:= bat.append(b,b);
base:= algebra.copy(b);

io.print(base);
mosaic.compress(b,"runlength");
b:= mosaic.decompress(b);
io.print(b);
# OID list compressions


o := 19531025:int;

f:= bat.new(:flt);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.314);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.316);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);
bat.append(f,0.317);


io.print(f);
mosaic.compress(f,"runlength");
f:= mosaic.decompress(f);
io.print(f);

bs:= bat.new(:timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:00:00":timestamp);
bat.append(bs,"2014-08-14 12:01:00":timestamp);
bat.append(bs,"2014-08-14 12:02:00":timestamp);
bs:= bat.append(bs,bs);

io.print(bs);
mosaic.compress(bs,"runlength");
bs:= mosaic.decompress(bs);
io.print(bs);

d:= bat.new(:date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-14":date);
bat.append(d,"2014-08-15":date);
d:= bat.append(d,d);

io.print(d);
mosaic.compress(d,"runlength");
d:= mosaic.decompress(d);
io.print(d);


# handle compression of strings
s:= bat.new(:str);
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"hello world");
bat.append(s,"goodbye");
bat.append(s,"goodbye");
bat.append(s,"goodbye");
bat.append(s,"goodbye");
bat.append(s,"goodbye");

io.print(s);
mosaic.compress(s);
s:= mosaic.decompress(s);
io.print(s);
