b:= bat.new(:timestamp);
bat.append(b,"2014-08-14 12:00:00":timestamp);
bat.append(b,"2014-08-14 12:00:00":timestamp);
bat.append(b,"2014-08-14 12:01:00":timestamp);
bat.append(b,"2014-08-14 12:02:00":timestamp);
bat.append(b,"2014-08-14 12:00:00":timestamp);
bat.append(b,"2014-08-14 12:00:00":timestamp);
bat.append(b,"2014-08-14 12:00:00":timestamp);
bat.append(b,"2014-08-14 12:01:00":timestamp);
bat.append(b,"2014-08-14 12:02:00":timestamp);
bat.append(b,"2014-08-14 12:00:00":timestamp);
b:= bat.append(b,b);
base:= algebra.copy(b);

mosaic.compress(b,"frame");
b:= mosaic.decompress(b);
io.print(base, b);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,false,false);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,false,false);
io.print(s, xs);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,false,false);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,false,false);
io.print(s, xs);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,true,false);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,true,false);
io.print(s, xs);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,true,false);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,true,false);
io.print(s, xs);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,false,true);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,false,true);
io.print(s, xs);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,false,true);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,false,true);
io.print(s, xs);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,true,true);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,false,true,true);
io.print(s, xs);

s:= algebra.select(base,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,true,true);
xs:= mosaic.select(b,"2014-08-14 12:00:00":timestamp,"2014-08-14 12:02:00":timestamp,true,true,true);
io.print(s, xs);
